//
//  FIULoginViewController.m
//  Mobile Clinic
//
//  Created by sebastian a zanlongo on 2/2/13.
//  Copyright (c) 2013 Steven Berlanga. All rights reserved.
//
#import "ServerCore.h"
#import "FIULoginViewController.h"
#import "UserObject.h"

UserObject* user;
@interface FIULoginViewController ()

@end

@implementation FIULoginViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    
	// Do any additional setup after loading the view.
}
-(void)viewWillAppear:(BOOL)animated{
    if (!user) {
        user = [[UserObject alloc]init];
    }

}
- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)viewDidUnload {
    [self setUserNameField:nil];
    [self setUserNameField:nil];
    [self setPasswordField:nil];
    [super viewDidUnload];
}

/* If you want to login, use the following information (case-sensitive)
 * Username: mick
 * Password: 616
 */
- (IBAction)loginButton:(id)sender {
    [user setUsername: _userNameField.text];
    [user setPassword:_passwordField.text];

    [user login:^(id<BaseObjectProtocol> data) {
        NSLog(@"This is where you put your code to deal with when login was successfull");
        
      id navCtrl = [self getViewControllerFromiPadStoryboardWithName:@"mainNavigationController"];
    
        [self presentViewController:navCtrl animated:YES completion:^{
        
            [FIUAppDelegate getNotificationWithColor:AJNotificationTypeGreen Animation:AJLinedBackgroundTypeAnimated WithMessage:@"You Succesfully Logged In"];
            }];
    }];
}
@end
